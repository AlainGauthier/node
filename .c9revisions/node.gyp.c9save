{"ts":1353355556652,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"{\n  'variables': {\n    'v8_use_snapshot%': 'true',\n    # Turn off -Werror in V8\n    # See http://codereview.chromium.org/8159015\n    'werror': '',\n    'node_use_dtrace%': 'false',\n    'node_use_etw%': 'false',\n    'node_shared_v8%': 'false',\n    'node_shared_zlib%': 'false',\n    'node_use_openssl%': 'true',\n    'node_use_systemtap%': 'false',\n    'node_shared_openssl%': 'false',\n    'library_files': [\n      'src/node.js',\n      'lib/_debugger.js',\n      'lib/_linklist.js',\n      'lib/assert.js',\n      'lib/buffer.js',\n      'lib/buffer_ieee754.js',\n      'lib/child_process.js',\n      'lib/console.js',\n      'lib/constants.js',\n      'lib/crypto.js',\n      'lib/cluster.js',\n      'lib/dgram.js',\n      'lib/dns.js',\n      'lib/domain.js',\n      'lib/events.js',\n      'lib/freelist.js',\n      'lib/fs.js',\n      'lib/http.js',\n      'lib/https.js',\n      'lib/module.js',\n      'lib/net.js',\n      'lib/os.js',\n      'lib/path.js',\n      'lib/punycode.js',\n      'lib/querystring.js',\n      'lib/readline.js',\n      'lib/repl.js',\n      'lib/stream.js',\n      'lib/string_decoder.js',\n      'lib/sys.js',\n      'lib/timers.js',\n      'lib/tls.js',\n      'lib/tty.js',\n      'lib/url.js',\n      'lib/util.js',\n      'lib/vm.js',\n      'lib/zlib.js',\n    ],\n  },\n\n  'targets': [\n    {\n      'target_name': 'node',\n      'type': 'executable',\n\n      'dependencies': [\n        'deps/cares/cares.gyp:cares',\n        'deps/http_parser/http_parser.gyp:http_parser',\n        'deps/uv/uv.gyp:libuv',\n        'node_js2c#host',\n      ],\n\n      'include_dirs': [\n        'src',\n        'deps/uv/src/ares',\n        '<(SHARED_INTERMEDIATE_DIR)' # for node_natives.h\n      ],\n\n      'sources': [\n        'src/fs_event_wrap.cc',\n        'src/cares_wrap.cc',\n        'src/handle_wrap.cc',\n        'src/node.cc',\n        'src/node_buffer.cc',\n        'src/node_constants.cc',\n        'src/node_extensions.cc',\n        'src/node_file.cc',\n        'src/node_http_parser.cc',\n        'src/node_javascript.cc',\n        'src/node_main.cc',\n        'src/node_os.cc',\n        'src/node_script.cc',\n        'src/node_stat_watcher.cc',\n        'src/node_string.cc',\n        'src/node_zlib.cc',\n        'src/pipe_wrap.cc',\n        'src/signal_wrap.cc',\n        'src/stream_wrap.cc',\n        'src/slab_allocator.cc',\n        'src/tcp_wrap.cc',\n        'src/timer_wrap.cc',\n        'src/tty_wrap.cc',\n        'src/process_wrap.cc',\n        'src/v8_typed_array.cc',\n        'src/udp_wrap.cc',\n        # headers to make for a more pleasant IDE experience\n        'src/handle_wrap.h',\n        'src/node.h',\n        'src/node_buffer.h',\n        'src/node_constants.h',\n        'src/node_crypto.h',\n        'src/node_extensions.h',\n        'src/node_file.h',\n        'src/node_http_parser.h',\n        'src/node_javascript.h',\n        'src/node_os.h',\n        'src/node_root_certs.h',\n        'src/node_script.h',\n        'src/node_string.h',\n        'src/node_version.h',\n        'src/ngx-queue.h',\n        'src/pipe_wrap.h',\n        'src/tty_wrap.h',\n        'src/tcp_wrap.h',\n        'src/udp_wrap.h',\n        'src/req_wrap.h',\n        'src/slab_allocator.h',\n        'src/stream_wrap.h',\n        'src/tree.h',\n        'src/v8_typed_array.h',\n        'deps/http_parser/http_parser.h',\n        '<(SHARED_INTERMEDIATE_DIR)/node_natives.h',\n        # javascript files to make for an even more pleasant IDE experience\n        '<@(library_files)',\n        # node.gyp is added to the project by default.\n        'common.gypi',\n      ],\n\n      'defines': [\n        'NODE_WANT_INTERNALS=1',\n        'ARCH=\"<(target_arch)\"',\n        'PLATFORM=\"<(OS)\"',\n      ],\n\n      'conditions': [\n        [ 'node_use_openssl==\"true\"', {\n          'defines': [ 'HAVE_OPENSSL=1' ],\n          'sources': [ 'src/node_crypto.cc' ],\n          'conditions': [\n            [ 'node_shared_openssl==\"false\"', {\n              'dependencies': [ './deps/openssl/openssl.gyp:openssl' ],\n            }]]\n        }, {\n          'defines': [ 'HAVE_OPENSSL=0' ]\n        }],\n        [ 'node_use_dtrace==\"true\"', {\n          'defines': [ 'HAVE_DTRACE=1' ],\n          'dependencies': [ 'node_dtrace_header' ],\n          'include_dirs': [ '<(SHARED_INTERMEDIATE_DIR)' ],\n          #\n          # node_dtrace_provider.cc and node_dtrace_ustack.cc do not actually\n          # exist.  They're here to trick GYP into linking the corresponding\n          # object files into the final \"node\" executable.  These files are\n          # generated by \"dtrace -G\" using custom actions below, and the\n          # GYP-generated Makefiles will properly build them when needed.\n          #\n          'sources': [\n            'src/node_dtrace.cc',\n            'src/node_dtrace_provider.cc'\n          ],\n          'conditions': [ [\n            'target_arch==\"ia32\"', {\n              'sources': [ 'src/node_dtrace_ustack.cc' ]\n            }\n          ] ],\n        } ],\n        [ 'node_use_systemtap==\"true\"', {\n          'defines': [ 'HAVE_SYSTEMTAP=1', 'STAP_SDT_V1=1' ],\n          'dependencies': [ 'node_systemtap_header' ],\n          'include_dirs': [ '<(SHARED_INTERMEDIATE_DIR)' ],\n          'sources': [\n            'src/node_dtrace.cc',\n            '<(SHARED_INTERMEDIATE_DIR)/node_systemtap.h',\n          ],\n        } ],\n        [ 'node_use_etw==\"true\"', {\n          'defines': [ 'HAVE_ETW=1' ],\n          'dependencies': [ 'node_etw' ],\n          'sources': [\n            'src/node_win32_etw_provider.h',\n            'src/node_win32_etw_provider-inl.h',\n            'src/node_win32_etw_provider.cc',\n            'src/node_dtrace.cc',\n            '<(SHARED_INTERMEDIATE_DIR)/node_etw_provider.h',\n            '<(SHARED_INTERMEDIATE_DIR)/node_etw_provider.rc',\n          ]\n        } ],\n        [ 'node_shared_v8==\"false\"', {\n          'sources': [\n            'deps/v8/include/v8.h',\n            'deps/v8/include/v8-debug.h',\n          ],\n          'dependencies': [ 'deps/v8/tools/gyp/v8.gyp:v8' ],\n        }],\n\n        [ 'node_shared_zlib==\"false\"', {\n          'dependencies': [ 'deps/zlib/zlib.gyp:zlib' ],\n        }],\n\n        [ 'OS==\"win\"', {\n          'sources': [\n            'src/res/node.rc',\n          ],\n          'defines': [\n            'FD_SETSIZE=1024',\n            # we need to use node's preferred \"win32\" rather than gyp's preferred \"win\"\n            'PLATFORM=\"win32\"',\n            '_UNICODE=1',\n          ],\n          'libraries': [ '-lpsapi.lib' ]\n        }, { # POSIX\n          'defines': [ '__POSIX__' ],\n        }],\n        [ 'OS==\"mac\"', {\n          'libraries': [ '-framework Carbon' ],\n          'defines!': [\n            'PLATFORM=\"mac\"',\n          ],\n          'defines': [\n            # we need to use node's preferred \"darwin\" rather than gyp's preferred \"mac\"\n            'PLATFORM=\"darwin\"',\n          ],\n        }],\n        [ 'OS==\"freebsd\"', {\n          'libraries': [\n            '-lutil',\n            '-lkvm',\n          ],\n        }],\n        [ 'OS==\"solaris\"', {\n          'libraries': [\n            '-lkstat',\n            '-lumem',\n          ],\n          'defines!': [\n            'PLATFORM=\"solaris\"',\n          ],\n          'defines': [\n            # we need to use node's preferred \"sunos\"\n            # rather than gyp's preferred \"solaris\"\n            'PLATFORM=\"sunos\"',\n          ],\n        }],\n      ],\n      'msvs_settings': {\n        'VCLinkerTool': {\n          'SubSystem': 1, # /subsystem:console\n        },\n      },\n    },\n    # generate ETW header and resource files\n    {\n      'target_name': 'node_etw',\n      'type': 'none',\n      'conditions': [\n        [ 'node_use_etw==\"true\"', {\n          'actions': [\n            {\n              'action_name': 'node_etw',\n              'inputs': [ 'src/res/node_etw_provider.man' ],\n              'outputs': [\n                '<(SHARED_INTERMEDIATE_DIR)/node_etw_provider.rc',\n                '<(SHARED_INTERMEDIATE_DIR)/node_etw_provider.h',\n              ],\n              'action': [ 'mc <@(_inputs) -h <(SHARED_INTERMEDIATE_DIR) -r <(SHARED_INTERMEDIATE_DIR)' ]\n            }\n          ]\n        } ]\n      ]\n    },\n    {\n      'target_name': 'node_js2c',\n      'type': 'none',\n      'toolsets': ['host'],\n      'actions': [\n        {\n          'action_name': 'node_js2c',\n\n          'inputs': [\n            '<@(library_files)',\n            './config.gypi',\n          ],\n\n          'outputs': [\n            '<(SHARED_INTERMEDIATE_DIR)/node_natives.h',\n          ],\n\n          # FIXME can the following conditions be shorted by just setting\n          # macros.py into some variable which then gets included in the\n          # action?\n\n          'conditions': [\n            [ 'node_use_dtrace==\"true\"'\n              ' or node_use_etw==\"true\"'\n              ' or node_use_systemtap==\"true\"',\n            {\n              'action': [\n                'python',\n                'tools/js2c.py',\n                '<@(_outputs)',\n                '<@(_inputs)',\n              ],\n            }, { # No Dtrace\n              'action': [\n                'python',\n                'tools/js2c.py',\n                '<@(_outputs)',\n                '<@(_inputs)',\n                'src/macros.py'\n              ],\n            }]\n          ],\n        },\n      ],\n    }, # end node_js2c\n    {\n      'target_name': 'node_dtrace_header',\n      'type': 'none',\n      'conditions': [\n        [ 'node_use_dtrace==\"true\"', {\n          'actions': [\n            {\n              'action_name': 'node_dtrace_header',\n              'inputs': [ 'src/node_provider.d' ],\n              'outputs': [ '<(SHARED_INTERMEDIATE_DIR)/node_provider.h' ],\n              'action': [ 'dtrace', '-h', '-xnolibs', '-s', '<@(_inputs)',\n                '-o', '<@(_outputs)' ]\n            }\n          ]\n        } ]\n      ]\n    },\n    {\n      'target_name': 'node_systemtap_header',\n      'type': 'none',\n      'conditions': [\n        [ 'node_use_systemtap==\"true\"', {\n          'actions': [\n            {\n              'action_name': 'node_systemtap_header',\n              'inputs': [ 'src/node_systemtap.d' ],\n              'outputs': [ '<(SHARED_INTERMEDIATE_DIR)/node_systemtap.h' ],\n              'action': [ 'dtrace', '-h', '-C', '-s', '<@(_inputs)',\n                '-o', '<@(_outputs)' ]\n            }\n          ]\n        } ]\n      ]\n    },\n    {\n      'target_name': 'node_dtrace_provider',\n      'type': 'none',\n      'conditions': [\n        [ 'node_use_dtrace==\"true\"', {\n          'actions': [\n            {\n              'action_name': 'node_dtrace_provider_o',\n              'inputs': [\n                'src/node_provider.d',\n                '<(PRODUCT_DIR)/obj.target/node/src/node_dtrace.o'\n              ],\n              'outputs': [\n                '<(PRODUCT_DIR)/obj.target/node/src/node_dtrace_provider.o'\n              ],\n              'action': [ 'dtrace', '-G', '-xnolibs', '-s', '<@(_inputs)',\n                '-o', '<@(_outputs)' ]\n            }\n          ]\n        } ]\n      ]\n    },\n    {\n      'target_name': 'node_dtrace_ustack',\n      'type': 'none',\n      'conditions': [\n        [ 'node_use_dtrace==\"true\" and target_arch==\"ia32\"', {\n          'actions': [\n            {\n              'action_name': 'node_dtrace_ustack_constants',\n              'inputs': [\n                '<(PRODUCT_DIR)/obj.target/deps/v8/tools/gyp/libv8_base.a'\n              ],\n              'outputs': [\n                '<(SHARED_INTERMEDIATE_DIR)/v8constants.h'\n              ],\n              'action': [\n                'tools/genv8constants.py',\n                '<@(_outputs)',\n                '<@(_inputs)'\n              ]\n            },\n            {\n              'action_name': 'node_dtrace_ustack',\n              'inputs': [\n                'src/v8ustack.d',\n                '<(SHARED_INTERMEDIATE_DIR)/v8constants.h'\n              ],\n              'outputs': [\n                '<(PRODUCT_DIR)/obj.target/node/src/node_dtrace_ustack.o'\n              ],\n              'action': [\n                'dtrace', '-32', '-I<(SHARED_INTERMEDIATE_DIR)', '-Isrc',\n                '-C', '-G', '-s', 'src/v8ustack.d', '-o', '<@(_outputs)',\n              ]\n            }\n          ]\n        } ],\n      ]\n    }\n  ] # end targets\n}\n\n"]],"start1":0,"start2":0,"length1":0,"length2":12096}]],"length":12096}
